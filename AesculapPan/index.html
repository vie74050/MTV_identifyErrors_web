<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>BCIT | 3D Activity Viewer</title>
    <link
      rel="shortcut icon"
      href="https://learn.bcit.ca/shared/scripts/interactive/UnityModelViewerTemplateData/favicon.ico"
    />
    <!-- jquery & jquery ui min -->
    <link rel="stylesheet" href="../Libs/jquery-bootstrap-UMV.min.css" />
    <script src="../Libs/jquery.min.js"></script>

    <!-- Unity Handlers-->
    <link rel="stylesheet" href="../Scripts/styles.css" />
    <script
      src="https://learn.bcit.ca/shared/scripts/interactive/UnityModelViewerTemplateData/FromToUnityHandlers.js"
      type="text/javascript"
    ></script>
  </head>

  <body>
    <div class="mmd instructions">
      <b>Select</b> Click
      <img
        src="https://learn.bcit.ca/shared/scripts/interactive/UnityModelViewerTemplateData/mouse-lf.png"
        alt="left mouse"
      />
      | <b>Pan</b> Drag
      <img
        src="https://learn.bcit.ca/shared/scripts/interactive/UnityModelViewerTemplateData/mouse-lf.png"
        alt="left mouse"
      />
      or arrow keys | <b>Rotate</b> Drag
      <img
        src="https://learn.bcit.ca/shared/scripts/interactive/UnityModelViewerTemplateData/mouse-rt.png"
        alt="right mouse click"
      />
      or A,D | <b>Zoom</b> Scroll
      <img
        src="https://learn.bcit.ca/shared/scripts/interactive/UnityModelViewerTemplateData/mouse-wheel.png"
        alt="scroll wheel"
      />
      or W,S
    </div>

    <div id="loading-cover">
      <div id="logo"><img src="logo.png"></div>  

      <div id="unity-loading-bar">        
        <div id="unity-progress-bar-empty" ></div>
          <div id="unity-progress-bar-full"></div>
        </div>
        <div class="spinner"></div>
      </div>
    </div>

    <!-- Unity editor v22.1.7 webpage loading -->
    <script>
      const canvas = document.createElement("CANVAS");
      canvas.id = "unity-canvas";
      canvas.width = 1224;
      canvas.height = 600;
      document.body.appendChild(canvas);

      const buildUrl = "Build";
      const loaderUrl = buildUrl + "/AesculapPan.loader.js";
      const config = {
        dataUrl: buildUrl + "/AesculapPan.data.gz",
        frameworkUrl: buildUrl + "/AesculapPan.framework.js.gz",
        codeUrl: buildUrl + "/AesculapPan.wasm.gz",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "BCIT SOH",
        productName: "MTV_identfyErrors",
        productVersion: "0.1",
      };
      
      const loadingCover = document.querySelector("#loading-cover");
      const progressBarEmpty = document.querySelector("#unity-progress-bar-empty");
      const progressBarFull = document.querySelector("#unity-progress-bar-full");
      const fullscreenButton = document.querySelector("#unity-fullscreen-button");
      const spinner = document.querySelector('.spinner');

      const script = document.createElement("script");
      script.src = loaderUrl;

      script.onload = () => {
        if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
          // Mobile device style: fill the whole browser client area with the game canvas:
          var meta = document.createElement("meta");
          meta.name = "viewport";
          meta.content =
            "width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes";
          document.getElementsByTagName("head")[0].appendChild(meta);
        }

        createUnityInstance(canvas, config, (progress) => {
          spinner.style.display = "none";
          progressBarEmpty.style.display = "";
          progressBarFull.style.width = `${100 * progress}%`;
        }).then((unityInstance) => {
          loadingCover.style.display = "none";
        }).catch((message) => {
          alert(message);
        });
      };
      document.body.appendChild(script);
      
      // expect / deliminted string of game object names
      var arList;
      function FromUnity_SetListItems(str) {
        arList = str.split("\\");
      }
    </script>

    <!-- content table that can be filled out in D2L web editor: Part name must match target part name in model -->
    <table>
      <thead>
        <tr>
          <th>Name: must match part name on model</th>
          <th>Content</th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>GO name</td>
          <td>
            <p>dialog message</p>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>
